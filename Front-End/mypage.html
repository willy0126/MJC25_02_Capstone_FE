<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>마이페이지 - 책·이음</title>
    <link rel="icon" type="image/png" href="assets/logo/tplogo.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Paperlogy:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="css/navbar.css">
    <link rel="stylesheet" href="css/footer.css">
    <link rel="stylesheet" href="css/mypage.css">
    <link rel="stylesheet" href="css/toast.css">
</head>
<body>
    <div id="navbar-placeholder"></div>

    <!-- 비밀번호 재확인 모달 -->
    <div id="passwordVerifyModal" class="modal">
        <div class="modal-content">
            <h2>비밀번호 확인</h2>
            <p>회원정보 보호를 위해 비밀번호를 다시 한 번 입력해주세요.</p>
            <form id="passwordVerifyForm">
                <div class="input-group">
                    <img class="icon-small" src="assets/pics/lock.png" alt="자물쇠 아이콘">
                    <input type="password" id="verifyPassword" name="password" placeholder="비밀번호" required autocomplete="current-password">
                </div>
                <div class="modal-buttons">
                    <button type="button" class="btn-cancel" onclick="window.history.back()">취소</button>
                    <button type="submit" class="btn-confirm">확인</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 마이페이지 메인 컨텐츠 -->
    <main class="mypage-container" id="mypageContent" style="display: none;">
        <div class="mypage-header">
            <h1>마이페이지</h1>
            <p class="subtitle">내 정보를 관리하고 활동 내역을 확인하세요</p>
        </div>

        <div class="mypage-content">
            <!-- 프로필 섹션 -->
            <section class="profile-section">
                <h2>프로필 정보</h2>
                <div class="profile-card">
                    <div class="profile-avatar">
                        <div class="avatar-circle" id="userAvatar">
                            <span id="userInitial">U</span>
                        </div>
                        <div class="color-indicator" id="userColor"></div>
                    </div>
                    <div class="profile-info">
                        <div class="info-row">
                            <label>이메일</label>
                            <span id="userEmail">-</span>
                        </div>
                        <div class="info-row">
                            <label>이름</label>
                            <span id="userName">-</span>
                        </div>
                        <div class="info-row">
                            <label>닉네임</label>
                            <span id="userNickname">-</span>
                        </div>
                        <div class="info-row">
                            <label>전화번호</label>
                            <span id="userPhone">-</span>
                        </div>
                        <div class="info-row">
                            <label>생년월일</label>
                            <span id="userBirth">-</span>
                        </div>
                        <div class="info-row">
                            <label>주소</label>
                            <span id="userAddress">-</span>
                        </div>
                    </div>
                </div>
                <div class="profile-actions">
                    <button class="btn-edit" onclick="editProfile()">정보 수정</button>
                    <button class="btn-change-password" onclick="resetPassword()">비밀번호 재설정</button>
                </div>
            </section>

            <!-- 구독 정보 섹션 -->
            <section class="subscription-section">
                <h2>구독 정보</h2>
                <div class="subscription-card">
                    <div class="subscription-status">
                        <span class="status-badge" id="subscriptionStatus">미구독</span>
                    </div>
                    <div class="subscription-details" id="subscriptionDetails">
                        <p>현재 구독 중인 플랜이 없습니다.</p>
                    </div>
                    <button class="btn-subscribe" onclick="goToSubscription()">구독 플랜 보기</button>
                </div>
            </section>

            <!-- 계정 관리 섹션 -->
            <section class="account-section">
                <h2>계정 탈퇴</h2>
                <div class="account-actions">
                    <button class="btn-logout" onclick="logout()">로그아웃</button>
                    <button class="btn-delete-account" onclick="deleteAccount()">회원 탈퇴</button>
                </div>
            </section>
        </div>
    </main>

    <div id="footer-placeholder"></div>

    <!-- 회원 탈퇴 확인 모달 -->
    <div id="deleteAccountModal" class="modal" style="display: none;">
        <div class="modal-content delete-modal">
            <h2>회원 탈퇴</h2>
            <div class="warning-box">
                <p>⚠️ 회원 탈퇴 시 모든 정보가 삭제됩니다.</p>
                <p>이 작업은 되돌릴 수 없습니다.</p>
            </div>
            <p class="confirm-message">정말로 탈퇴하시겠습니까? 비밀번호를 입력해주세요.</p>
            <form id="deleteAccountForm">
                <div class="input-group">
                    <img class="icon-small" src="assets/pics/lock.png" alt="자물쇠 아이콘">
                    <input type="password" id="deletePassword" name="password" placeholder="비밀번호" required autocomplete="current-password">
                </div>
                <div class="modal-buttons">
                    <button type="button" class="btn-cancel" onclick="closeDeleteModal()">취소</button>
                    <button type="submit" class="btn-delete-confirm">탈퇴하기</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 프로필 수정 모달 -->
    <div id="editProfileModal" class="modal" style="display: none;">
        <div class="modal-content edit-profile-modal">
            <h2>프로필 수정</h2>
            <form id="editProfileForm">
                <div class="form-group">
                    <label for="editNickname">닉네임</label>
                    <input type="text" id="editNickname" name="nickname" placeholder="닉네임을 입력하세요" maxlength="20">
                </div>

                <div class="form-group">
                    <label for="editPhone">전화번호</label>
                    <input type="tel" id="editPhone" name="phone" placeholder="010-1234-5678">
                </div>

                <div class="form-group">
                    <label for="editAddress">주소</label>
                    <input type="text" id="editAddress" name="address" placeholder="주소를 입력하세요">
                </div>

                <div class="form-group">
                    <label>프로필 색상</label>
                    <div class="color-picker">
                        <div class="color-palette" id="colorPalette">
                            <!-- 색상 옵션들이 JavaScript로 동적 생성 -->
                        </div>
                        <div class="selected-color-display">
                            <span>선택된 색상:</span>
                            <div class="color-preview" id="selectedColorPreview"></div>
                            <span class="color-hex" id="selectedColorHex">#20B2AA</span>
                        </div>
                    </div>
                </div>

                <div class="modal-buttons">
                    <button type="button" class="btn-cancel" onclick="closeEditModal()">취소</button>
                    <button type="submit" class="btn-confirm">저장</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 로그아웃 확인 모달 -->
    <div id="logoutModal" class="modal" style="display: none;">
        <div class="modal-content logout-modal">
            <h2>로그아웃</h2>
            <p class="confirm-message">정말 로그아웃 하시겠습니까?</p>
            <div class="modal-buttons">
                <button type="button" class="btn-cancel" onclick="closeLogoutModal()">취소</button>
                <button type="button" class="btn-confirm" onclick="confirmLogout()">확인</button>
            </div>
        </div>
    </div>

    <!-- 비밀번호 재설정 모달 -->
    <div id="resetPasswordModal" class="modal" style="display: none;">
        <div class="modal-content reset-password-modal">
            <h2>비밀번호 재설정</h2>
            <p class="description">새로운 비밀번호를 입력해주세요.</p>
            <form id="resetPasswordForm">
                <div class="form-group">
                    <label for="newPassword">새 비밀번호</label>
                    <input type="password" id="newPassword" name="newPassword" placeholder="영문, 숫자, 특수문자 포함 8자 이상" required>
                    <small class="password-hint">영문, 숫자, 특수문자(@$!%*#?&)를 포함한 8자리 이상</small>
                </div>

                <div class="form-group">
                    <label for="confirmNewPassword">새 비밀번호 확인</label>
                    <input type="password" id="confirmNewPassword" name="confirmNewPassword" placeholder="비밀번호를 다시 입력하세요" required>
                    <small class="error-message" id="newPasswordError">비밀번호가 일치하지 않습니다.</small>
                </div>

                <div class="modal-buttons">
                    <button type="button" class="btn-cancel" onclick="closeResetPasswordModal()">취소</button>
                    <button type="submit" class="btn-confirm">재설정</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 커스텀 커서 -->
    <div class="cursor-dot"></div>
    <div class="cursor-outline"></div>

    <!-- 스크립트 -->
    <script src="js/toast.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/constants.js"></script>
    <script src="js/api-client.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/include.js"></script>
    <script src="js/cursor.js"></script>
    <script src="js/mypage.js"></script>
</body>
</html>
